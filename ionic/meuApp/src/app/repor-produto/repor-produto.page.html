<ion-header id="texto" style="background: #896b02; font-family: 'Century Gothic';">
  <ion-toolbar color="#c99e02">
    <ion-buttons slot="start">
      <ion-button (click)="openMenu()">
        <ion-icon slot="icon-only" name="menu"></ion-icon>
      </ion-button>
      <ion-avatar>
        <img src="../assets/Logomarca.png" />
      </ion-avatar>
    </ion-buttons>
    <ion-title style="font-size: 22px; font-weight: bold;">REPOSIÇÃO<br> DE PRODUTO</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content id="fundo" style="font-family: 'Century Gothic';">
  <div class="fornecedor-section">
    <fieldset>
      <legend>
        <h2 style="font-weight: bold; text-transform: uppercase; font-size: 20px;">
          <ion-icon name="people-circle-outline"></ion-icon> Fornecedor
        </h2>
      </legend>
      <ion-item>
        <ion-label position="fixed" style="font-weight: bold; ">Fornecedor:</ion-label>
        <ion-select [(ngModel)]="fornecedor" (ngModelChange)="carregarfonrcedor()" name="fornecedor" placeholder="Selecione">
          <ion-select-option *ngFor="let fornecedor of fornecedores" [value]="fornecedor.Nome">
              {{ fornecedor.Nome }}
          </ion-select-option>
      </ion-select>
    </ion-item>
    </fieldset>
  </div>
  <div class="Produto-section">
    <fieldset>
      <legend>
        <h2 style="font-weight: bold; text-transform: uppercase; font-size: 20px;">
          <ion-icon name="document-outline"></ion-icon> Produto
        </h2>
      </legend>
      <form id="Produto-form" (ngSubmit)="addToCart()">
        <ion-item>
          <ion-label position="floating" style="font-weight: bold;">Código:</ion-label>
          <ion-input
            [(ngModel)]="ProdutoCode"
            (ngModelChange)="carregarProduto()"
            type="number"
            name="ProdutoCode"
            min="0"
            placeholder="Digite o código"
          ></ion-input>
        </ion-item>
        

        <ion-item>
          <ion-label position="fixed" style="font-weight: bold;">Nome:</ion-label>
          <span>{{ ProdutoNome || '---' }}</span>
        </ion-item>
        <ion-item>
          <ion-label position="floating" style="font-weight: bold;">Quantidade:</ion-label>
          <ion-input
            type="number"
            [(ngModel)]="quantidade"
            name="quantidade"
            required
            min="1">
          </ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating" style="font-weight: bold;">Valor Pago R$:</ion-label>
          <ion-input type="text" [(ngModel)]="formatototal" name="total" required (ionBlur)="formatoDinheiro()" placeholder="0,00"></ion-input>
      </ion-item>


        <ion-button expand="full" color="light" type="submit">
          <ion-icon name="add-circle-outline"></ion-icon> Adicionar ao Carrinho
        </ion-button>
        <ion-button expand="full" color="light" type="button" (click)="limparCampos()">
          <ion-icon name="trash-sharp"></ion-icon> Limpar Campos
        </ion-button>
      </form>
    </fieldset>
  </div>

  <div class="cart-section">
    <fieldset>
      <legend>
        <h2 style="font-weight: bold; text-transform: uppercase; font-size: 20px;">
          <ion-icon name="cart-sharp"></ion-icon> Carrinho de Reposição
        </h2>
      </legend>
      <ion-list id="list">
        <ion-label>
          <h3 style="font-family: tahoma; font-weight: bold; font-size: 12px;">COD | PROD | QTD | TOTAL R$</h3>
        </ion-label>
        <ion-item *ngFor="let item of cart; let i = index">
          <ion-label>
            <p style="font-family: Arial;font-size: 10px;">
              {{ item.code }} | {{ item.name }} | {{ item.quantidade }} | {{ formatoDinheiroDisplay(item.total) }}
            </p>
          </ion-label>
          <ion-button slot="end" color="danger" (click)="removeFromCart(i)" style="font-size: 9px;">
            <ion-icon name="trash-outline" style="font-size: 12px;"></ion-icon> Remover
          </ion-button>
        </ion-item>
        
      </ion-list>
   </fieldset>
  </div>

  
  <div class="cart-section">
    <fieldset>
    <ion-item>
      <ion-label position="fixed" style="font-weight: bold;">
        <h3 style="font-weight: bold;">TOTAL (R$):</h3>
      </ion-label>
      <ion-input
        type="text"
        name="valorTotal"
        [(ngModel)]="formatoValorTotal"
        (ionInput)="manualEdit = true" 
        readonly
        (ionBlur)="formatoDinheiroValorTotal()"
        placeholder="0,00"
        style="font-family: Arial;">
      </ion-input>
    </ion-item>
      
      <ion-item>
        <ion-label position="floating" style="font-weight: bold;">Chave de Acesso da NF-e:</ion-label>
        <ion-textarea
          type="text"
          [(ngModel)]="chaveDeAcesso"
          name="chaveDeAcesso"
          maxlength="49"
          (ngModelChange)="formatarChaveDeAcesso()"
          rows="2"
    cols="40"
          [value]="chaveDeAcessoExibicao"
          placeholder="Digite apenas números"
        ></ion-textarea>
      </ion-item>
  
    
  </fieldset>
  <ion-button expand="full" color="success" (click)="ConfirmarCadastro()">
    <ion-icon name="checkmark-circle-sharp"></ion-icon> Confirmar Pedido
  </ion-button>
  <ion-button expand="full" color="danger" (click)="cancelSale()">
    <ion-icon name="close-circle-sharp"></ion-icon> Cancelar Pedido
  </ion-button>
</div>
</ion-content>


<style>
  .Produto-section, .cart-section, .fornecedor-section {
    padding: 16px;
    margin-bottom: 16px;
    background: #c99e02;
    border-radius: 17px;
    box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.1);
  }

  h2 {
    margin-bottom: 16px;
  }

  ion-button {
    margin-top: 8px;
  }

  ion-label {
    font-family: Arial;
    font-weight: bold;
    font-size: 17px;
  }
</style>
